---
import { Image } from "astro:assets";
import s1 from "src/assets/company/Google-Ads-h.png";
import s2 from "src/assets/company/App-Store.png";
import s3 from "src/assets/company/Google-Business-h-2.png";
import s4 from "src/assets/company/React-h.png";
import s5 from "src/assets/company/Shopify-h.png";
import s6 from "src/assets/company/Stripe-h.png";
import s7 from "src/assets/company/Wordpress-h.png";
import s8 from "src/assets/company/meta.svg";
import Section from "./Section.astro";

const sponsors = [
  { logo: s1, alt: "Google Ads" },
  { logo: s6, alt: "Stripe" },
  { logo: s5, alt: "Shopify" },
  { logo: s7, alt: "WordPress" },
  { logo: s8, alt: "Meta" },
  { logo: s4, alt: "React" },
  { logo: s3, alt: "Google My Business" },
  { logo: s2, alt: "App Store" }
];
---

<Section id="sponsors" class="py-12 bg-white">
  <div class="mx-auto max-w-6xl">
    <!-- Scrollable wrapper -->
    <div id="logo-wrapper" class="overflow-x-auto no-scrollbar scroll-smooth">
      <!-- Long logo track -->
      <div id="logo-track" class="flex w-max gap-x-6">
        {
          [...sponsors, ...sponsors, ...sponsors, ...sponsors].map((sponsor, index) => (
            <div class="w-48 h-20 flex items-center justify-center flex-shrink-0 p-4">
            <Image
              src={sponsor.logo}
              alt={sponsor.alt}
              loading="lazy"
              class="h-full object-contain grayscale hover:grayscale-0 transition duration-200"
            />
          </div>
          ))
        }
      </div>
    </div>
  </div>
</Section>

<style>
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
</style>

<script type="module">
  if (typeof window !== "undefined") {
    const wrapper = document.getElementById('logo-wrapper');

    // Run after layout is ready
    window.addEventListener('load', () => {
      const logo = wrapper.querySelector('.w-48');
      if (!wrapper || !logo) return;

      const scrollStep = logo.offsetWidth + 24; // 24 = gap-x-6
      let scrollAmount = 0;

      setInterval(() => {
        scrollAmount += scrollStep;
        if (scrollAmount >= wrapper.scrollWidth / 2) {
          scrollAmount = 0;
        }
        wrapper.scrollTo({ left: scrollAmount, behavior: 'smooth' });
      }, 2500);
    });
  }
</script>